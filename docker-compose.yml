version: '3'

services:

  # apache:
  #   build: web/apache
  #   # restart: unless-stopped
  #   ports:
  #     - "${APACHE_PORT}:80"
  #     - "${APACHE_SSL_PORT}:443"  
  #   volumes:
  #     - "${PHP_CONF}:/usr/local/etc/php/php.ini"
  #     - "${APACHE_CONF}:/etc/apache2/sites-available/000-default.conf"
  #     - "${PROJECT_DIR}:/var/www"
  #   links:
  #     - "php"

  nginx:
    build: web/nginx
    # restart: unless-stopped
    ports:
      - "${NGINX_PORT}:80"
      - "${NGINX_SSL_PORT}:443"  
    volumes:
      - "${NGINX_CONF}:/etc/nginx/conf.d/default.conf"
      - "${PROJECT_DIR}:/var/www"
    links:
      - "php"
      
  php:
    build: app/php/8.1
    # restart: unless-stopped
    volumes:
      - "${PHP_CONF}:/usr/local/etc/php/php.ini"
      - "${PROJECT_DIR}:/var/www"
    links:
      - "mysql"
      - "postgresql"

  # node:
  #   build: app/nodejs/20
  #   ports:
  #     - "${NODE_PORT}:${NODE_PORT}"  
  #   restart: unless-stopped
  #   volumes:
  #     - "${NODE_APP_DIR}:/app"   
   
  mysql:
    build: database/mysql
    # restart: unless-stopped
    ports:
      - 3306:3306
    volumes:
      - "${DB_DIR}:/var/lib/mysql"

  postgresql:
    build: database/postgresql
    # restart: unless-stopped
    ports:
      - 5432:5432
    volumes:
      - "${DB_DIR}:/var/lib/postgresql/data"

  adminer:
    image: adminer
    # restart: always
    ports:
      - "${ADMINER_PORT}:8080"
